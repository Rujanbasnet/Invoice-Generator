<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Create Invoice â€” InvoicePro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="css/modern-ui.css">
  <script src="js/data-manager.js"></script>
  <script src="js/sidebarTemplate.js"></script>
  <script src="js/client-modal.js"></script>
  <style>
    /* A4 Paper Preview */
    .a4-paper {
      width: 210mm;
      min-height: 297mm;
      background: white;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      margin: 0 auto;
      padding: 20mm;
      font-size: 14px;
      line-height: 1.5;
      color: #334155;
    }

    @media (max-width: 1280px) {
      .a4-paper {
        width: 100%;
        padding: 20px;
        min-height: auto;
      }
    }
  </style>
</head>

<body class="antialiased bg-slate-50">

  <div class="flex min-h-screen">
    <script>injectSidebar('create-invoice');</script>

    <main class="flex-1 flex flex-col h-screen overflow-hidden">
      <!-- Topbar -->
      <header
        class="modern-topbar flex items-center justify-between px-8 py-4 sticky top-0 z-20 bg-white/80 backdrop-blur-md border-b border-slate-200">
        <div>
          <h2 class="text-xl font-bold text-slate-800">New Invoice</h2>
        </div>
        <div class="flex gap-3">
          <button id="downloadBtn" class="secondary-action">
            <i class="fa-solid fa-download"></i> Download
          </button>
          <button id="saveDraftBtn" class="secondary-action">Save Draft</button>
          <button id="sendInvoiceBtn" class="primary-action">
            <i class="fa-solid fa-paper-plane"></i> Send Invoice
          </button>
        </div>
      </header>

      <!-- Split View Content -->
      <div class="flex-1 flex overflow-hidden">

        <!-- LEFT: Editor (Scrollable) -->
        <div class="w-1/2 overflow-y-auto p-8 border-r border-slate-200 bg-white">
          <div class="max-w-2xl mx-auto space-y-8">

            <!-- Logo Upload -->
            <div class="space-y-2">
              <label class="block text-sm font-semibold text-slate-700">Company Logo</label>
              <div class="flex items-center gap-4">
                <div id="logoPreviewBox"
                  class="w-16 h-16 rounded-lg border border-dashed border-slate-300 flex items-center justify-center bg-slate-50 text-slate-400 overflow-hidden">
                  <i class="fa-solid fa-image"></i>
                </div>
                <label class="secondary-action cursor-pointer">
                  Upload Logo
                  <input type="file" id="logoInput" class="hidden" accept="image/*" />
                </label>
              </div>
            </div>

            <!-- Invoice Details -->
            <div class="grid grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Invoice No.</label>
                <div class="relative">
                  <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400">#</span>
                  <input type="text" id="invoiceId" class="modern-input pl-7" />
                </div>
              </div>
              <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Recurring?</label>
                <label class="relative inline-flex items-center cursor-pointer mt-2">
                  <input type="checkbox" id="recurringToggle" class="sr-only peer">
                  <div
                    class="w-11 h-6 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-600">
                  </div>
                  <span class="ml-3 text-sm font-medium text-slate-700">Repeat Monthly</span>
                </label>
              </div>
            </div>

            <!-- Client & Dates -->
            <div class="grid grid-cols-2 gap-6">
              <div class="col-span-2">
                <label class="block text-sm font-semibold text-slate-700 mb-1">Bill To</label>
                <select id="clientSelect" class="modern-input">
                  <option value="">Select Client...</option>
                  <option value="new" class="font-bold text-emerald-600">+ Add New Client</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Issue Date</label>
                <input type="date" id="issueDate" class="modern-input" />
              </div>
              <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Due Date</label>
                <input type="date" id="dueDate" class="modern-input" />
              </div>
            </div>

            <hr class="border-slate-100" />

            <!-- Line Items -->
            <div class="space-y-4">
              <div class="flex justify-between items-center">
                <h3 class="font-bold text-slate-800">Items</h3>
              </div>

              <!-- Add Item Form -->
              <div class="p-4 bg-slate-50 rounded-xl border border-slate-200 space-y-3">
                <div class="grid grid-cols-12 gap-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1">
                  <div class="col-span-6">Description</div>
                  <div class="col-span-2 text-center">Qty</div>
                  <div class="col-span-2 text-right">Price</div>
                  <div class="col-span-2 text-right">Total</div>
                </div>
                <div class="grid grid-cols-12 gap-3">
                  <div class="col-span-6">
                    <input type="text" id="newItemDesc" placeholder="Description" class="modern-input text-sm" />
                  </div>
                  <div class="col-span-2">
                    <input type="number" id="newItemQty" placeholder="Qty" value="1" min="1"
                      class="modern-input text-sm text-center" />
                  </div>
                  <div class="col-span-2">
                    <input type="number" id="newItemPrice" placeholder="Price" min="0" step="0.01"
                      class="modern-input text-sm text-right" />
                  </div>
                  <div class="col-span-2">
                    <input type="text" id="newItemTotal" placeholder="Total" readonly
                      class="modern-input text-sm text-right bg-slate-100 text-slate-500" />
                  </div>
                </div>
                <button id="addItemBtn"
                  class="w-full py-2 bg-white border border-slate-300 text-slate-600 font-medium rounded-lg hover:bg-slate-50 hover:text-emerald-600 transition-colors text-sm flex items-center justify-center gap-2">
                  <i class="fa-solid fa-plus"></i> Add Item
                </button>
              </div>

              <!-- Items List (Mini View) -->
              <div id="editorItemsList" class="space-y-2">
                <!-- Items added here -->
              </div>
            </div>

            <!-- Discount & Tax -->
            <div class="grid grid-cols-2 gap-6">
              <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Discount (%)</label>
                <input type="number" id="invoiceDiscount" placeholder="0" min="0" max="100" class="modern-input" />
              </div>
              <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Tax Rate (%)</label>
                <input type="number" id="invoiceTax" placeholder="0" min="0" max="100" class="modern-input" />
              </div>
            </div>

            <!-- Notes -->
            <div>
              <label class="block text-sm font-semibold text-slate-700 mb-1">Notes / Terms</label>
              <textarea id="invoiceNotes" rows="3" class="modern-input"
                placeholder="Payment terms, thank you note, etc."></textarea>
            </div>

          </div>
        </div>

        <!-- RIGHT: Live Preview (Scrollable) -->
        <div class="w-1/2 bg-slate-100 overflow-y-auto p-8 flex justify-center">
          <div id="invoicePreview" class="a4-paper flex flex-col">

            <!-- Header -->
            <div class="flex justify-between items-start mb-12">
              <div>
                <div id="previewLogo" class="mb-4 hidden">
                  <img src="" alt="Logo" class="h-12 object-contain" />
                </div>
                <h1 class="text-3xl font-bold text-slate-900">INVOICE</h1>
                <p class="text-slate-500 mt-1">#<span id="previewId">INV-001</span></p>
              </div>
              <div class="text-right">
                <h3 class="font-bold text-slate-900">Your Company Name</h3>
                <p class="text-slate-500 text-sm">123 Business Rd<br>City, State 12345</p>
              </div>
            </div>

            <!-- Client & Dates -->
            <div class="flex justify-between mb-12">
              <div>
                <p class="text-xs font-bold text-slate-400 uppercase mb-2">Bill To</p>
                <div id="previewClient">
                  <p class="text-slate-400 italic">Select a client...</p>
                </div>
              </div>
              <div class="text-right space-y-2">
                <div>
                  <p class="text-xs font-bold text-slate-400 uppercase">Date</p>
                  <p id="previewDate" class="font-medium text-slate-900">-</p>
                </div>
                <div>
                  <p class="text-xs font-bold text-slate-400 uppercase">Due Date</p>
                  <p id="previewDueDate" class="font-medium text-slate-900">-</p>
                </div>
              </div>
            </div>

            <!-- Table -->
            <table class="w-full mb-8">
              <thead>
                <tr class="border-b-2 border-slate-100">
                  <th class="text-left py-3 font-bold text-slate-600">Description</th>
                  <th class="text-center py-3 font-bold text-slate-600 w-20">Qty</th>
                  <th class="text-right py-3 font-bold text-slate-600 w-32">Price</th>
                  <th class="text-right py-3 font-bold text-slate-600 w-32">Total</th>
                </tr>
              </thead>
              <tbody id="previewItemsBody">
                <!-- Items injected -->
              </tbody>
            </table>

            <!-- Totals -->
            <div class="flex justify-end mb-12">
              <div class="w-64 space-y-2">
                <div class="flex justify-between text-slate-500">
                  <span>Subtotal</span>
                  <span id="previewSubtotal">$0.00</span>
                </div>
                <div class="flex justify-between text-slate-500">
                  <span>Discount</span>
                  <span id="previewDiscount">-$0.00</span>
                </div>
                <div class="flex justify-between text-slate-500">
                  <span>Tax</span>
                  <span id="previewTax">$0.00</span>
                </div>
                <div class="flex justify-between text-xl font-bold text-slate-900 pt-2 border-t border-slate-200">
                  <span>Total</span>
                  <span id="previewTotal">$0.00</span>
                </div>
              </div>
            </div>

            <!-- Footer -->
            <div class="mt-auto pt-8 border-t border-slate-100">
              <p class="font-bold text-slate-800 mb-2">Notes</p>
              <p id="previewNotes" class="text-sm text-slate-500">Thank you for your business!</p>
            </div>

          </div>
        </div>

      </div>
    </main>
  </div>

  <script src="js/sidebar.js"></script>
  <script src="js/create-invoice.js"></script>
</body>

</html>